"use strict";(self.webpackChunkportal_meu_rh=self.webpackChunkportal_meu_rh||[]).push([[970],{23831:function(e,t,i){i.d(t,{o:function(){return f}});var n=i(64762),o=i(92340),a=i(81483),l=i(81059),s=i(36227),c=i(97185),r=i(37716),p=i(38583),d=i(29790),u=i(32268);function g(e,t){if(1&e&&(r.TgZ(0,"div",15),r.TgZ(1,"div",5),r.TgZ(2,"span"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"div",13),r.TgZ(6,"span"),r._uU(7),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(2);r.xp6(3),r.Oqu(r.lcZ(4,2,"l-total-hours")),r.xp6(4),r.Oqu(t.formatHours(e.total))}}function h(e,t){if(1&e&&(r.TgZ(0,"div",11),r.TgZ(1,"div",12),r.TgZ(2,"div",5),r.TgZ(3,"span"),r._uU(4),r.qZA(),r.qZA(),r.TgZ(5,"div",13),r.TgZ(6,"span"),r._uU(7),r.qZA(),r.qZA(),r.qZA(),r.YNc(8,g,8,4,"div",14),r.qZA()),2&e){const e=t.$implicit,i=r.oxw(2);r.xp6(4),r.Oqu(e.description),r.xp6(3),r.Oqu(i.formatHours(e.initHour,e.endHour)),r.xp6(1),r.Q6J("ngIf",i.showTotal)}}function m(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",16),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.mobileShowDetails=!t.mobileShowDetails}),r.TgZ(1,"span"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(2),r.Oqu(r.lcZ(3,1,e.mobileShowDetails?"l-hide-details":"l-show-details-2"))}}function w(e,t){if(1&e&&(r.TgZ(0,"div",1),r.TgZ(1,"div",2),r.TgZ(2,"div",3),r.TgZ(3,"div",4),r.TgZ(4,"h2",5),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(7,"div",3),r.TgZ(8,"div",6),r.TgZ(9,"span",7),r._uU(10),r.ALo(11,"utcDate"),r.qZA(),r.TgZ(12,"span",8),r._uU(13),r.ALo(14,"titlecase"),r.ALo(15,"utcDate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(16,"div",3),r.YNc(17,h,9,3,"div",9),r.ALo(18,"slice"),r.YNc(19,m,4,3,"div",10),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(5),r.Oqu(r.lcZ(6,5,"l-dailySummary")),r.xp6(5),r.Oqu(r.xi3(11,7,e.date,"shortDate")),r.xp6(3),r.Oqu(r.lcZ(14,10,r.xi3(15,12,e.date,"EEEE"))),r.xp6(4),r.Q6J("ngForOf",r.Dn7(18,15,e.dailySummaryResponse.items,0,e.mobileShowDetails||!e.viewIsMobileOrTablet?e.dailySummaryResponse.items.length:1)),r.xp6(2),r.Q6J("ngIf",e.viewIsMobileOrTablet&&e.dailySummaryResponse.items.length>1)}}let f=(()=>{class e extends l.R{constructor(e,t){super(),this.occurrencesService=e,this.fieldPropertiesService=t,this.mobileShowDetails=!1,this.showTotal=!1}get hasDailySummary(){var e,t;return(null===(t=null===(e=this.dailySummaryResponse)||void 0===e?void 0:e.items)||void 0===t?void 0:t.length)>0}ngOnInit(){super.ngOnInit(),this.loadFieldProperties()}ngOnChanges(e){var t,i;const n=null===(t=e.employeeId)||void 0===t?void 0:t.currentValue;let o=null===(i=e.date)||void 0===i?void 0:i.currentValue;null!=o&&"string"==typeof o&&(o=new Date(o)),(this.lastDate!==o||this.lastEmployeeId!=n)&&this.getDailySummary(o),this.lastDate=o,this.lastEmployeeId=n}formatHours(e,t){if(e>=0){const i=a.Em.getHoursByMilliseconds(e);return null!=t&&t>=0?`${i} - ${a.Em.getHoursByMilliseconds(t)}`:i}}loadFieldProperties(){return(0,n.mG)(this,void 0,void 0,function*(){const e=yield this.fieldPropertiesService.getFieldProperties("dailySummary");null!=e&&e.forEach(e=>{"total"===e.field&&(this.showTotal=null!=e&&e.visible)})})}getDailySummary(e){var t;return(0,n.mG)(this,void 0,void 0,function*(){return this.dailySummaryResponse=null==e?null:yield this.occurrencesService.getOccurrencesOfDay(null!==(t=this.employeeId)&&void 0!==t?t:o.N.loggedUser,e),this.dailySummaryResponse})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(c.$),r.Y36(s.c))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-daily-summary"]],inputs:{date:"date",employeeId:"employeeId"},features:[r.qOj,r.TTD],decls:1,vars:1,consts:[["class","daily-summary",4,"ngIf"],[1,"daily-summary"],[1,"header"],[1,"po-row"],[1,"po-sm-12"],[1,"title"],[1,"po-sm-12","date"],[1,"full","po-mr-lg-2","po-mr-xl-2"],[1,"day"],["class","po-sm-12 po-md-12 po-lg-6 po-xl-4 item",4,"ngFor","ngForOf"],["class","button-details",3,"click",4,"ngIf"],[1,"po-sm-12","po-md-12","po-lg-6","po-xl-4","item"],[1,"info","info-left"],[1,"value"],["class","info info-right",4,"ngIf"],[1,"info","info-right"],[1,"button-details",3,"click"]],template:function(e,t){1&e&&r.YNc(0,w,20,19,"div",0),2&e&&r.Q6J("ngIf",t.hasDailySummary)},directives:[p.O5,p.sg],pipes:[d.X$,u.$,p.rS,p.OU],styles:['.daily-summary[_ngcontent-%COMP%]{border-radius:3px;background-color:#fff;box-shadow:0 2px 8px #e3e6f1;margin-top:16px;padding:16px 8px 0}@media (min-width: 961px){.daily-summary[_ngcontent-%COMP%]{padding-bottom:8px}}.daily-summary[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:"NunitoSans-bold";font-weight:400;color:#0c9abe;font-size:18px}@media (min-width: 961px){.daily-summary[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#000;font-size:20px}}.daily-summary[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{margin-bottom:14.5px;font-size:20px;display:flex}@media (min-width: 961px){.daily-summary[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-size:inherit;display:block}}.daily-summary[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   .full[_ngcontent-%COMP%]{font-family:"NunitoSans-bold";font-weight:400;width:60%}.daily-summary[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]{width:40%;color:#8e8e93;margin-left:40px}@media (min-width: 961px){.daily-summary[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]{margin-left:0}}.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin:8.5px 0;display:flex}.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-size:12px}@media (min-width: 961px){.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-size:inherit}}.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%] ~ .info[_ngcontent-%COMP%]{margin-left:40px}.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .info.info-left[_ngcontent-%COMP%]{width:60%}.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .info.info-right[_ngcontent-%COMP%]{width:40%}.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{overflow:hidden;word-break:break-word}.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:"NunitoSans-bold";font-weight:400}@media (min-width: 961px){.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .info.info-left[_ngcontent-%COMP%]{width:200px}.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .info.info-right[_ngcontent-%COMP%]{width:110px}.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:"NunitoSans-bold";font-weight:400;color:#4a5c60}.daily-summary[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:"NunitoSans";font-weight:200}}.daily-summary[_ngcontent-%COMP%]   .button-details[_ngcontent-%COMP%]{position:relative;padding:8.5px 0;display:flex;width:100%;justify-content:center;color:#0c9abe;cursor:pointer}.daily-summary[_ngcontent-%COMP%]   .button-details[_ngcontent-%COMP%]:before{content:"";display:block;position:absolute;top:0;left:-8px;background:#eceded;height:1px;width:calc(100% + 16px)}']}),e})()},76970:function(e,t,i){i.r(t),i.d(t,{AllowanceListRoutingModule:function(){return ke}});var n=i(95987),o=i(51110),a=i(64762),l=i(37716),s=i(92340),c=(()=>((c||(c={})).StatusEnum={Pending:"pending",Rejected:"rejected",Approved:"approved"},c))(),r=i(33490),p=i(44852),d=i(44956),u=i(72212),g=i(49512),h=i(65241),m=i(38583),w=i(29790),f=i(32268),y=i(18648);function A(e,t){if(1&e&&(l.TgZ(0,"span",3),l.TgZ(1,"div",4),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.TgZ(4,"div",5),l._uU(5),l.ALo(6,"utcDate"),l.qZA(),l.qZA()),2&e){const e=l.oxw(2);l.xp6(2),l.Oqu(l.lcZ(3,2,"l-initial-date")),l.xp6(3),l.Oqu(l.xi3(6,4,e.allowance.initDate,"dd/MM/yyyy"))}}function Z(e,t){if(1&e&&(l.TgZ(0,"span",3),l.TgZ(1,"div",4),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.TgZ(4,"div",5),l._uU(5),l.ALo(6,"utcDate"),l.qZA(),l.qZA()),2&e){const e=l.oxw(2);l.xp6(2),l.Oqu(l.lcZ(3,2,"l-end-date")),l.xp6(3),l.Oqu(l.xi3(6,4,e.allowance.endDate,"dd/MM/yyyy"))}}function x(e,t){if(1&e&&(l.TgZ(0,"div",6),l.TgZ(1,"span",3),l.TgZ(2,"div",4),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.TgZ(5,"div",5),l._uU(6),l.ALo(7,"formatMillisecondsAsHour"),l.qZA(),l.qZA(),l.TgZ(8,"span",3),l.TgZ(9,"div",4),l._uU(10),l.ALo(11,"translate"),l.qZA(),l.TgZ(12,"div",5),l._uU(13),l.ALo(14,"formatMillisecondsAsHour"),l.qZA(),l.qZA(),l.qZA()),2&e){const e=l.oxw(2);l.xp6(3),l.Oqu(l.lcZ(4,4,"l-initial-hour")),l.xp6(3),l.Oqu(l.lcZ(7,6,e.allowance.initHour)),l.xp6(4),l.Oqu(l.lcZ(11,8,"l-final-hour")),l.xp6(3),l.Oqu(l.lcZ(14,10,e.allowance.endHour))}}function b(e,t){if(1&e&&(l.TgZ(0,"div",6),l.TgZ(1,"span",9),l.TgZ(2,"div",4),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.TgZ(5,"div",5),l._uU(6),l.ALo(7,"formatMillisecondsAsHour"),l.qZA(),l.qZA(),l.qZA()),2&e){const e=l.oxw(2);l.xp6(3),l.Oqu(l.lcZ(4,2,"l-total-hours")),l.xp6(3),l.Oqu(l.lcZ(7,4,e.allowance.totalMinutes))}}function v(e,t){if(1&e&&(l.TgZ(0,"div"),l.TgZ(1,"div",2),l.TgZ(2,"span",3),l.TgZ(3,"div",4),l._uU(4),l.ALo(5,"translate"),l.qZA(),l.TgZ(6,"div",5),l._uU(7),l.qZA(),l.qZA(),l.qZA(),l.TgZ(8,"div",6),l.YNc(9,A,7,7,"span",7),l.YNc(10,Z,7,7,"span",7),l.qZA(),l.YNc(11,x,15,12,"div",8),l.YNc(12,b,8,6,"div",8),l.qZA()),2&e){const e=l.oxw();l.xp6(4),l.Oqu(l.lcZ(5,6,"l-allowanceType")),l.xp6(3),l.Oqu(e.allowance.allowanceType.description),l.xp6(2),l.Q6J("ngIf",e.isVisible(e.allowance,"initDate",!0)),l.xp6(1),l.Q6J("ngIf",e.isVisible(e.allowance,"endDate",!0)),l.xp6(1),l.Q6J("ngIf",e.isVisible(e.allowance,"period",!0)),l.xp6(1),l.Q6J("ngIf",e.isVisible(e.allowance,"totalHour",!1))}}let T=(()=>{class e{constructor(e,t){this.appTranslateService=e,this.allowanceService=t,this.deleted=new l.vpe,this.confirmAction={label:"l-delete",action:()=>this.excludeAllowance()},this.cancelAction={label:"l-cancel",action:()=>this.excludeDialog.close()}}ngOnInit(){this.translateLabelConfirm()}translateLabelConfirm(){for(let e of[this.confirmAction,this.cancelAction])this.appTranslateService.getI18n(e.label).then(t=>{e.label=t})}openDialog(){this.excludeDialog.open()}excludeAllowance(){return(0,a.mG)(this,void 0,void 0,function*(){if(this.employeeId||(this.employeeId=s.N.loggedUser),this.allowance.canAlter)try{yield this.allowanceService.deleteAllowance(this.allowance.id,this.employeeId),this.deleted.emit()}finally{this.excludeDialog.close()}})}isVisible(e,t,i){return e&&e.allowanceType.props&&e.allowanceType.props.length?u.Z.isVisible(e.allowanceType.props,t):i}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(h.g),l.Y36(g.n))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-allowance-exclude"]],viewQuery:function(e,t){if(1&e&&l.Gf(d.hmF,5),2&e){let e;l.iGM(e=l.CRH())&&(t.excludeDialog=e.first)}},inputs:{allowance:"allowance",employeeId:"employeeId"},outputs:{deleted:"deleted"},decls:3,vars:6,consts:[["p-click-out","true","p-size","sm",3,"p-title","p-primary-action","p-secondary-action"],[4,"ngIf"],[1,"po-row","first-row"],[1,"po-sm-6","po-md-6","po-lg-6","po-xl-6","no-padding"],[1,"requested-label"],[1,"requested-value"],[1,"po-row"],["class","po-sm-6 po-md-6 po-lg-6 po-xl-6 no-padding",4,"ngIf"],["class","po-row",4,"ngIf"],[1,"po-sm-12","po-md-12","po-lg-12","po-xl-12","no-padding"]],template:function(e,t){1&e&&(l.TgZ(0,"po-modal",0),l.ALo(1,"translate"),l.YNc(2,v,13,8,"div",1),l.qZA()),2&e&&(l.s9C("p-title",l.lcZ(1,4,"l-ask-delete-allowance")),l.Q6J("p-primary-action",t.confirmAction)("p-secondary-action",t.cancelAction),l.xp6(2),l.Q6J("ngIf",t.allowance))},directives:[d.hmF,m.O5],pipes:[w.X$,f.$,y.P],styles:["[_nghost-%COMP%]     .thf-modal-title{font-weight:bold;white-space:normal;font-size:16px}[_nghost-%COMP%]     .thf-icon-close{display:none}@media only screen and (min-width: 768px){[_nghost-%COMP%]     .thf-modal-title{font-size:24px}}.first-row[_ngcontent-%COMP%]{margin-bottom:5px}.requested-value[_ngcontent-%COMP%]{font-weight:bold;margin-top:-4px}.requested-label[_ngcontent-%COMP%]{font-weight:bold;opacity:.7}"]}),e})();var M=i(68014),q=i(81483),C=i(96054),O=i(3679),_=i(47106);function H(e,t){if(1&e&&(l.TgZ(0,"option",11),l._uU(1),l.qZA()),2&e){const e=t.$implicit,i=l.oxw(2);l.Q6J("ngValue",e)("selected",i.changeSelectType(e)),l.xp6(1),l.hij(" ",e.description," ")}}function P(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"span",12),l.TgZ(1,"po-datepicker",13),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw(2).initDateEdit=t}),l.ALo(2,"translate"),l.qZA(),l.qZA()}if(2&e){const e=l.oxw(2);l.xp6(1),l.s9C("p-label",l.lcZ(2,2,"l-initial-date")),l.Q6J("ngModel",e.initDateEdit)}}function I(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"span",12),l.TgZ(1,"po-datepicker",14),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw(2).endDateEdit=t}),l.ALo(2,"translate"),l.qZA(),l.qZA()}if(2&e){const e=l.oxw(2);l.xp6(1),l.s9C("p-label",l.lcZ(2,2,"l-end-date")),l.Q6J("ngModel",e.endDateEdit)}}function D(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",15),l.TgZ(1,"span",12),l.TgZ(2,"span",4),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.TgZ(5,"po-input",16),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw(2).iniHourEdit=t}),l.qZA(),l.qZA(),l.TgZ(6,"span",12),l.TgZ(7,"span",4),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.TgZ(10,"po-input",17),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw(2).endHourEdit=t}),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.oxw(2);l.xp6(3),l.Oqu(l.lcZ(4,8,"l-initial-hour")),l.xp6(2),l.Q6J("ngModel",e.iniHourEdit)("p-mask",e.mask)("p-pattern",e.pattern),l.xp6(3),l.Oqu(l.lcZ(9,10,"l-final-hour")),l.xp6(2),l.Q6J("ngModel",e.endHourEdit)("p-mask",e.mask)("p-pattern",e.pattern)}}function V(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",15),l.TgZ(1,"div",18),l.TgZ(2,"span",4),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.TgZ(5,"po-input",19),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw(2).totalHourEdit=t}),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.oxw(2);l.xp6(3),l.Oqu(l.lcZ(4,6,"l-total")),l.xp6(2),l.Q6J("p-required",e.isRequired(e.allowance,"totalHour"))("p-disabled",!e.isEditable(e.allowance,"totalHour"))("ngModel",e.totalHourEdit)("p-mask",e.mask)("p-pattern",e.pattern)}}function E(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",20),l.TgZ(1,"div",21),l.TgZ(2,"app-attach-file",22),l.NdJ("attachedFileChange",function(t){return l.CHM(e),l.oxw(2).attachedFile=t}),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.oxw(2);l.xp6(2),l.Q6J("attachedId",e.allowance.id)("attachedFile",e.attachedFile)}}function S(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div"),l.TgZ(1,"div",2),l.TgZ(2,"span",3),l.TgZ(3,"span",4),l._uU(4),l.ALo(5,"translate"),l.qZA(),l.TgZ(6,"select",5),l.NdJ("change",function(t){return l.CHM(e),l.oxw().updateAllowanceType(t.currentTarget.selectedIndex)}),l.YNc(7,H,2,3,"option",6),l.qZA(),l.qZA(),l.qZA(),l.TgZ(8,"div",7),l.YNc(9,P,3,4,"span",8),l.YNc(10,I,3,4,"span",8),l.qZA(),l.YNc(11,D,11,12,"div",9),l.YNc(12,V,6,8,"div",9),l.YNc(13,E,3,2,"div",10),l.qZA()}if(2&e){const e=l.oxw();l.xp6(4),l.Oqu(l.lcZ(5,7,"l-allowanceType")),l.xp6(3),l.Q6J("ngForOf",e.allowanceTypes),l.xp6(2),l.Q6J("ngIf",e.isVisible(e.allowance,"initDate")),l.xp6(1),l.Q6J("ngIf",e.isVisible(e.allowance,"endDate")),l.xp6(1),l.Q6J("ngIf",e.isVisible(e.allowance,"period")),l.xp6(1),l.Q6J("ngIf",e.isVisible(e.allowance,"totalHour")),l.xp6(1),l.Q6J("ngIf",e.canSendAttach)}}let L=(()=>{class e{constructor(e,t,i,n){this.appTranslateService=e,this.allowanceService=t,this.notificationService=i,this.permissionSelectors=n,this.allowanceTypes=[],this.mask="99:99",this.pattern="^(2[0-3]|[01]*[0-9]):?([0-5][0-9])$",this.isUpdateType=!1,this.confirmAction={label:"l-save",action:()=>{this.editAllowance()}},this.cancelAction={label:"l-cancel",action:()=>{this.ediAllowancetDialog.close()}},this.events=new l.vpe,this.edited=new l.vpe}ngOnInit(){this.watchPermissions()}ngOnDestroy(){this.events&&this.events.unsubscribe(),this.permissionsSubscription&&this.permissionsSubscription.unsubscribe()}initializeComponent(e){this.isUpdateType=!1,this.allowance=e,this.initDateEdit=q.Em.returnDateStringPODatepicker(this.allowance.initDate),this.endDateEdit=q.Em.returnDateStringPODatepicker(this.allowance.endDate),this.convertHour(),this.getFromServerAttachedFile()}changeSelectType(e){return e.id===this.allowanceTypeId}updateAllowanceType(e){(e||0===e)&&(this.idEdit=this.allowanceTypes[e].id,this.typeIdDescriptionEdit=this.allowanceTypes[e].description,this.requiredAttachmentEdit=this.allowanceTypes[e].requiredAttachment,this.isUpdateType=!0)}openDialog(){this.watchPermissions(),this.ediAllowancetDialog.open(),this.getAllowanceTypes(),this.translateLabelConfirm(),this.convertHour()}editAllowance(){return(0,a.mG)(this,void 0,void 0,function*(){if(this.employeeId||(this.employeeId=s.N.loggedUser),this.allowance.canAlter){const t=this.checkFormatHour(this.iniHourEdit),i=this.checkFormatHour(this.endHourEdit),n=this.checkFormatHour(this.totalHourEdit);if(this.validadeHourInputFormat(t,i))return;if(this.allowance.initDate=q.Em.formatUTCDate(new Date(this.initDateEdit)),this.allowance.endDate=q.Em.formatUTCDate(new Date(this.endDateEdit)),this.allowance.initHour=q.Em.getTotalMilliseconds(t),this.allowance.endHour=q.Em.getTotalMilliseconds(i),this.allowance.totalMinutes=q.Em.getTotalMilliseconds(n),this.isUpdateType){if(!this.validateAttachment(this.idEdit,this.requiredAttachmentEdit,this.attachedFile))return;this.allowance.allowanceType.id=this.idEdit,this.allowance.allowanceType.description=this.typeIdDescriptionEdit,this.allowance.allowanceType.requiredAttachment=this.requiredAttachmentEdit}else if(!this.validateAttachment(this.allowance.allowanceType.id,this.allowance.allowanceType.requiredAttachment,this.attachedFile))return;this.allowance.hasAttachment=null!=this.attachedFile,this.allowance.file=this.attachedFile;try{yield this.allowanceService.updateAllowance(this.employeeId,this.allowance.id,this.allowance),this.edited.emit(this.allowance),this.showMessageSuccess("l-msg-save-success"),this.ediAllowancetDialog.close()}catch(e){console.error(e)}}})}checkFormatHour(e){return e.indexOf(":")>=0?e:e.substr(0,2).concat(":").concat(e.substr(2,3))}showMessageSuccess(e){this.appTranslateService.getI18n(e).then(e=>{this.notificationService.showNotification(e,d.ik9.Success)})}isVisible(e,t){return!!(e&&e.allowanceType.props&&e.allowanceType.props.length)&&u.Z.isVisible(e.allowanceType.props,t)}isEditable(e,t){return!!(e&&e.allowanceType.props&&e.allowanceType.props.length)&&u.Z.isEditable(e.allowanceType.props,t)}isRequired(e,t){return!!(e&&e.allowanceType.props&&e.allowanceType.props.length)&&u.Z.isRequired(e.allowanceType.props,t)}convertHour(){this.allowance&&(this.iniHourEdit=q.Em.getHoursByMilliseconds(this.allowance.initHour),this.endHourEdit=q.Em.getHoursByMilliseconds(this.allowance.endHour),this.totalHourEdit=q.Em.getHoursByMilliseconds(this.allowance.totalMinutes),this.allowanceTypeId=this.allowance.allowanceType.id,this.allowanceDescription=this.allowance.allowanceType.description)}translateLabelConfirm(){for(let e of[this.confirmAction,this.cancelAction])this.appTranslateService.getI18n(e.label).then(t=>{e.label=t})}getAllowanceTypes(){this.allowanceService.getAllowancesTypes().then(e=>{this.allowanceTypes=e}).catch(e=>{console.error("Erro ao requisitar os tipos de abono: "+e)})}watchPermissions(){var e;null===(e=this.permissionsSubscription)||void 0===e||e.unsubscribe();const t=null!=this.employeeId&&"{current}"!==this.employeeId;this.permissionsSubscription=this.permissionSelectors.permissions$.subscribe(e=>{this.canSendAttach=e.sendAttachmentAllowance&&!t||e.teamManagementSendAttachmentAllowance&&t,this.canViewAttach=e.viewAttachmentAllowance&&!t||e.teamManagementViewAttachmentAllowance&&t})}getFromServerAttachedFile(){return(0,a.mG)(this,void 0,void 0,function*(){this.attachedFile=this.allowance.hasAttachment?yield this.allowanceService.getAttachedFile(this.allowance.id):null})}validateAttachment(e,t,i){return!e||!t||null!=i||(this.appTranslateService.getI18n("l-required-attachment").then(e=>{this.notificationService.showNotification(e,d.ik9.Error)}),!1)}validadeHourInputFormat(e,t){if(this.isVisible(this.allowance,"period")){if(5!=e.length)return this.appTranslateService.getI18n("m-initHourInvalid").then(e=>{this.notificationService.showNotification(e,d.ik9.Error)}),!0;if(5!=t.length)return this.appTranslateService.getI18n("m-endHourInvalid").then(e=>{this.notificationService.showNotification(e,d.ik9.Error)}),!0}return!1}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(h.g),l.Y36(g.n),l.Y36(C.g),l.Y36(M.eL))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-allowance-update"]],viewQuery:function(e,t){if(1&e&&(l.Gf(d.hmF,5),l.Gf(d.ZZR,7)),2&e){let e;l.iGM(e=l.CRH())&&(t.ediAllowancetDialog=e.first),l.iGM(e=l.CRH())&&(t.combo=e.first)}},inputs:{allowance:"allowance",employeeId:"employeeId",events:"events"},outputs:{edited:"edited"},decls:3,vars:6,consts:[["p-click-out","true",3,"p-title","p-primary-action","p-secondary-action"],[4,"ngIf"],[1,"po-row","first-row"],[1,"po-sm-12","po-md-12","po-lg-12","po-xl-12"],[1,"po-field-title","titleInput","space"],["id","allowanceType","name","allowanceType",1,"form-control",3,"change"],[3,"ngValue","selected",4,"ngFor","ngForOf"],[1,"po-row","second-row"],["class","po-sm-6 po-md-6 po-lg-6 po-xl-6",4,"ngIf"],["class","po-row third-row",4,"ngIf"],["class","po-row",4,"ngIf"],[3,"ngValue","selected"],[1,"po-sm-6","po-md-6","po-lg-6","po-xl-6"],["id","initDate","name","initDate","p-required","",3,"ngModel","p-label","ngModelChange"],["id","endDate","name","endDate","p-required","",3,"ngModel","p-label","ngModelChange"],[1,"po-row","third-row"],["id","initHour","p-maxlength","5","p-placeholder","00:00",1,"po-sm-12","po-md-12","po-lg-12","po-xl-12","no-padding",3,"ngModel","p-mask","p-pattern","ngModelChange"],["id","endHour","p-maxlength","5","p-placeholder","00:00",1,"po-sm-12","po-md-12","po-lg-12","po-xl-12","no-padding",3,"ngModel","p-mask","p-pattern","ngModelChange"],[1,"po-xl-6","po-lg-6","po-md-6","po-sm-6"],["id","totalMinutes","p-maxlength","5","p-placeholder","00:00",3,"p-required","p-disabled","ngModel","p-mask","p-pattern","ngModelChange"],[1,"po-row"],[1,"po-xl-12","po-lg-12","po-md-12","po-sm-12","no-padding"],["urlDownloadFile","timesheet/allowances/file/download","requirementsCss","po-mt-1 po-sm-12 po-md-12 po-lg-6 po-xl-6 no-padding","attachFileButtonCss","po-mt-1 po-sm-12 po-md-12 po-lg-3 po-xl-3 po-pt-1",3,"attachedId","attachedFile","attachedFileChange"]],template:function(e,t){1&e&&(l.TgZ(0,"po-modal",0),l.ALo(1,"translate"),l.YNc(2,S,14,9,"div",1),l.qZA()),2&e&&(l.s9C("p-title",l.lcZ(1,4,"l-edit-allowance")),l.Q6J("p-primary-action",t.confirmAction)("p-secondary-action",t.cancelAction),l.xp6(2),l.Q6J("ngIf",t.allowance))},directives:[d.hmF,m.O5,m.sg,O.YN,O.Kr,d.GWy,O.JJ,O.On,d.xxV,_.n],pipes:[w.X$],styles:[".first-row[_ngcontent-%COMP%]{margin-bottom:5px}.requested-value[_ngcontent-%COMP%]{font-weight:bold;margin-top:-4px}.requested-label[_ngcontent-%COMP%]{font-weight:bold;opacity:.7}"]}),e})();var k=i(66163),N=i(18494),J=i(97983),U=i(14833),F=i(63114),Q=i(37503),Y=i(84479),R=i(36812),G=i(20307),z=i(82832),$=i(90171);function j(e,t){if(1&e&&l._UZ(0,"app-card-employee",9),2&e){const e=l.oxw();l.Q6J("image",null==e.employeeCard?null:e.employeeCard.image)("name",null==e.employeeCard.employee?null:e.employeeCard.employee.name)("role",null==e.employeeCard.employee?null:e.employeeCard.employee.roleDescription)("status",null==e.employeeCard.employee?null:e.employeeCard.employee.employeeStatus)}}function B(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",26),l.TgZ(1,"span",27),l._UZ(2,"span",28),l.TgZ(3,"ul",29),l._UZ(4,"div",30),l.TgZ(5,"li",31),l.NdJ("click",function(){l.CHM(e);const t=l.oxw().$implicit;return l.oxw().openExcludeDialog(t)}),l._uU(6),l.ALo(7,"translate"),l.qZA(),l.TgZ(8,"li",31),l.NdJ("click",function(){l.CHM(e);const t=l.oxw().$implicit;return l.oxw().openEditDialog(t)}),l._uU(9),l.ALo(10,"translate"),l.qZA(),l.qZA(),l.qZA(),l.qZA()}2&e&&(l.xp6(6),l.hij(" ",l.lcZ(7,2,"l-delete")," "),l.xp6(3),l.hij(" ",l.lcZ(10,4,"l-edit")," "))}function X(e,t){if(1&e&&(l.TgZ(0,"span"),l.TgZ(1,"div",16),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.TgZ(4,"div",17),l._uU(5),l.ALo(6,"utcDate"),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit,t=l.oxw();l.Gre("po-sm-6 po-mt-md-1 ",t.isDayAllowance(e)&&t.isIntervalVisible(e)?"po-md-3":"po-md-4"," po-lg-2 po-xl-2 panel-item-group"),l.xp6(2),l.Oqu(l.lcZ(3,5,"l-end-date")),l.xp6(3),l.Oqu(l.xi3(6,7,e.endDate,"dd/MM/yyyy"))}}function W(e,t){if(1&e&&(l.TgZ(0,"span",32),l.TgZ(1,"div",16),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.TgZ(4,"div",17),l._uU(5),l.ALo(6,"formatMillisecondsAsHour"),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(2),l.Oqu(l.lcZ(3,2,"l-initial-hour")),l.xp6(3),l.Oqu(l.lcZ(6,4,e.initHour))}}function K(e,t){if(1&e&&(l.TgZ(0,"span",32),l.TgZ(1,"div",16),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.TgZ(4,"div",17),l._uU(5),l.ALo(6,"formatMillisecondsAsHour"),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(2),l.Oqu(l.lcZ(3,2,"l-final-hour")),l.xp6(3),l.Oqu(l.lcZ(6,4,e.endHour))}}function ee(e,t){if(1&e&&(l.TgZ(0,"span"),l.TgZ(1,"div",16),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.TgZ(4,"div",17),l._uU(5),l.ALo(6,"formatMillisecondsAsHour"),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit,t=l.oxw();l.Gre("po-sm-6 po-mt-md-1 ",t.isDayAllowance(e)&&t.isIntervalVisible(e)?"po-md-3":"po-md-4"," po-lg-2 po-xl-2 panel-item-group"),l.xp6(2),l.Oqu(l.lcZ(3,5,"l-total-hours")),l.xp6(3),l.Oqu(l.lcZ(6,7,e.totalMinutes))}}function te(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"span",33),l.TgZ(1,"po-button",34),l.NdJ("p-click",function(){l.CHM(e);const t=l.oxw().$implicit;return l.oxw().getAttachedFile(t.id)}),l.ALo(2,"translate"),l.qZA(),l.qZA()}2&e&&(l.xp6(1),l.MGl("p-label","\xa0",l.lcZ(2,1,"l-medical-certificate"),""))}function ie(e,t){1&e&&l._UZ(0,"span",35)}function ne(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"span",36),l.TgZ(1,"po-button",37),l.NdJ("p-click",function(){l.CHM(e);const t=l.oxw().$implicit;return l.oxw().getAttachedFile(t.id)}),l.ALo(2,"translate"),l.qZA(),l.qZA()}2&e&&(l.xp6(1),l.MGl("p-label","\xa0",l.lcZ(2,1,"l-medical-certificate"),""))}function oe(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"span",38),l.TgZ(1,"po-button",37),l.NdJ("p-click",function(){l.CHM(e);const t=l.oxw().$implicit;return l.oxw().getAttachedFile(t.id)}),l.ALo(2,"translate"),l.qZA(),l.qZA()}2&e&&(l.xp6(1),l.MGl("p-label","\xa0",l.lcZ(2,1,"l-medical-certificate"),""))}function ae(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"span",39),l.TgZ(1,"po-button",37),l.NdJ("p-click",function(){l.CHM(e);const t=l.oxw().$implicit;return l.oxw().getAttachedFile(t.id)}),l.ALo(2,"translate"),l.qZA(),l.qZA()}2&e&&(l.xp6(1),l.MGl("p-label","\xa0",l.lcZ(2,1,"l-view-medical-certificate"),""))}function le(e,t){if(1&e&&(l.TgZ(0,"app-card",10),l.TgZ(1,"div",11),l.TgZ(2,"h2",12),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.YNc(5,B,11,6,"div",13),l.qZA(),l.TgZ(6,"div",14),l.TgZ(7,"span",15),l.TgZ(8,"div",16),l._uU(9),l.ALo(10,"translate"),l.qZA(),l.TgZ(11,"div",17),l._uU(12),l.qZA(),l.qZA(),l.TgZ(13,"span"),l.TgZ(14,"div",16),l._uU(15),l.ALo(16,"translate"),l.qZA(),l.TgZ(17,"div",17),l._uU(18),l.ALo(19,"utcDate"),l.qZA(),l.qZA(),l.YNc(20,X,7,10,"span",18),l.YNc(21,W,7,6,"span",19),l.YNc(22,K,7,6,"span",19),l.YNc(23,ee,7,9,"span",18),l.TgZ(24,"span",20),l.TgZ(25,"div",16),l._uU(26),l.ALo(27,"translate"),l.qZA(),l.TgZ(28,"div",17),l._uU(29),l.qZA(),l.qZA(),l.YNc(30,te,3,3,"span",21),l.YNc(31,ie,1,0,"span",22),l.YNc(32,ne,3,3,"span",23),l.YNc(33,oe,3,3,"span",24),l.YNc(34,ae,3,3,"span",25),l.qZA(),l.qZA()),2&e){const e=t.$implicit,i=l.oxw();l.Q6J("cssClass","card-request-active po-xl-12 po-lg-12 po-md-12 po-sm-12"),l.xp6(3),l.Oqu(l.lcZ(4,21,"l-allowance-requested")),l.xp6(2),l.Q6J("ngIf",e.canAlter),l.xp6(4),l.Oqu(l.lcZ(10,23,"l-allowanceType")),l.xp6(3),l.Oqu(e.allowanceType.description),l.xp6(1),l.Gre("po-sm-6 po-mt-md-1 ",i.isDayAllowance(e)&&i.isIntervalVisible(e)?"po-md-3":"po-md-4"," po-lg-2 po-xl-2 panel-item-group"),l.xp6(2),l.Oqu(l.lcZ(16,25,"l-initial-date")),l.xp6(3),l.Oqu(l.xi3(19,27,e.initDate,"dd/MM/yyyy")),l.xp6(2),l.Q6J("ngIf",i.isVisible(e,"endDate")),l.xp6(1),l.Q6J("ngIf",i.isDayAllowance(e)&&i.isIntervalVisible(e)),l.xp6(1),l.Q6J("ngIf",i.isDayAllowance(e)&&i.isIntervalVisible(e)),l.xp6(1),l.Q6J("ngIf",!i.isDayAllowance(e)),l.xp6(3),l.Oqu(l.lcZ(27,30,"l-status")),l.xp6(3),l.Oqu(e.statusLabel),l.xp6(1),l.Q6J("ngIf",i.downloadButtonIsVisibleDesktopLine1(e)),l.xp6(1),l.Q6J("ngIf",i.isDayAllowance(e)&&i.isIntervalVisible(e)),l.xp6(1),l.Q6J("ngIf",i.downloadButtonIsVisibleDesktopLine2(e)),l.xp6(1),l.Q6J("ngIf",i.downloadButtonIsVisibleMdOrSmallerDevice(e)),l.xp6(1),l.Q6J("ngIf",i.downloadButtonIsVisibleMdOrSmallerDevice(e))}}function se(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",40),l.NdJ("click",function(){return l.CHM(e),l.oxw().viewMoreHistoryPending()}),l.TgZ(1,"a",null,41),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.qZA()}2&e&&(l.xp6(3),l.hij("",l.lcZ(4,1,"l-load-more")," "))}function ce(e,t){1&e&&l._UZ(0,"span",59)}function re(e,t){1&e&&l._UZ(0,"span",60)}function pe(e,t){if(1&e&&(l.TgZ(0,"span"),l._UZ(1,"hr",54),l.TgZ(2,"div",55),l.TgZ(3,"span",56),l._uU(4),l.ALo(5,"translate"),l.qZA(),l.TgZ(6,"span",57),l._uU(7),l.ALo(8,"utcDate"),l.qZA(),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(4),l.Oqu(l.lcZ(5,2,"l-end-date")),l.xp6(3),l.Oqu(l.xi3(8,4,e.endDate,"dd/MM/yyyy"))}}function de(e,t){if(1&e&&(l.TgZ(0,"span"),l._UZ(1,"hr",54),l.TgZ(2,"div",55),l.TgZ(3,"span",56),l._uU(4),l.ALo(5,"translate"),l.qZA(),l.TgZ(6,"span",57),l._uU(7),l.ALo(8,"formatMillisecondsAsHour"),l.qZA(),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(4),l.Oqu(l.lcZ(5,2,"l-initial-hour")),l.xp6(3),l.Oqu(l.lcZ(8,4,e.initHour))}}function ue(e,t){if(1&e&&(l.TgZ(0,"span"),l._UZ(1,"hr",54),l.TgZ(2,"div",55),l.TgZ(3,"span",56),l._uU(4),l.ALo(5,"translate"),l.qZA(),l.TgZ(6,"span",57),l._uU(7),l.ALo(8,"formatMillisecondsAsHour"),l.qZA(),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(4),l.Oqu(l.lcZ(5,2,"l-final-hour")),l.xp6(3),l.Oqu(l.lcZ(8,4,e.endHour))}}function ge(e,t){if(1&e&&(l.TgZ(0,"span"),l._UZ(1,"hr",54),l.TgZ(2,"div",55),l.TgZ(3,"span",56),l._uU(4),l.ALo(5,"translate"),l.qZA(),l.TgZ(6,"span",57),l._uU(7),l.ALo(8,"formatMillisecondsAsHour"),l.qZA(),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(4),l.Oqu(l.lcZ(5,2,"l-total-hours")),l.xp6(3),l.Oqu(l.lcZ(8,4,e.totalMinutes))}}function he(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"po-button",61),l.NdJ("p-click",function(){l.CHM(e);const t=l.oxw().$implicit;return l.oxw(2).getAttachedFile(t.id)}),l.ALo(1,"translate"),l.qZA()}2&e&&l.s9C("p-label",l.lcZ(1,1,"download-medical-certificate"))}const me=function(e,t){return{circleBase:!0,type1:e,type2:t}};function we(e,t){if(1&e&&(l.TgZ(0,"mat-expansion-panel",45,46),l.TgZ(2,"mat-expansion-panel-header",47),l.TgZ(3,"mat-panel-title"),l.TgZ(4,"div"),l._UZ(5,"div",48),l.TgZ(6,"span",49),l._uU(7),l.ALo(8,"utcDate"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(9,"mat-panel-description",50),l.TgZ(10,"div",51),l.YNc(11,ce,1,0,"span",52),l.YNc(12,re,1,0,"span",53),l.qZA(),l.qZA(),l.qZA(),l._UZ(13,"hr",54),l.TgZ(14,"div",55),l.TgZ(15,"span",56),l._uU(16),l.ALo(17,"translate"),l.qZA(),l.TgZ(18,"span",57),l._uU(19),l.qZA(),l.qZA(),l.TgZ(20,"span"),l._UZ(21,"hr",54),l.TgZ(22,"div",55),l.TgZ(23,"span",56),l._uU(24),l.ALo(25,"translate"),l.qZA(),l.TgZ(26,"span",57),l._uU(27),l.ALo(28,"utcDate"),l.qZA(),l.qZA(),l.qZA(),l.YNc(29,pe,9,7,"span",6),l.YNc(30,de,9,6,"span",6),l.YNc(31,ue,9,6,"span",6),l.TgZ(32,"span"),l._UZ(33,"hr",54),l.TgZ(34,"div",55),l.TgZ(35,"span",56),l._uU(36),l.ALo(37,"translate"),l.qZA(),l.TgZ(38,"span",57),l._uU(39),l.qZA(),l.qZA(),l.qZA(),l.YNc(40,ge,9,6,"span",6),l.YNc(41,he,2,3,"po-button",58),l.qZA()),2&e){const e=t.$implicit,i=l.MAs(1),n=l.oxw(2);l.xp6(5),l.Q6J("ngClass",l.WLB(28,me,n.isApproved(e.status),!n.isApproved(e.status))),l.xp6(2),l.AsE(" ",l.xi3(8,16,e.initDate,"dd/MM/yyyy")," - ",e.allowanceType.description," "),l.xp6(4),l.Q6J("ngIf",i.expanded),l.xp6(1),l.Q6J("ngIf",!i.expanded),l.xp6(4),l.Oqu(l.lcZ(17,19,"l-allowanceType")),l.xp6(3),l.Oqu(e.allowanceType.description),l.xp6(5),l.Oqu(l.lcZ(25,21,"l-initial-date")),l.xp6(3),l.Oqu(l.xi3(28,23,e.initDate,"dd/MM/yyyy")),l.xp6(2),l.Q6J("ngIf",n.isVisible(e,"endDate")),l.xp6(1),l.Q6J("ngIf",n.isDayAllowance(e)&&n.isIntervalVisible(e)),l.xp6(1),l.Q6J("ngIf",n.isDayAllowance(e)&&n.isIntervalVisible(e)),l.xp6(5),l.Oqu(l.lcZ(37,26,"l-status")),l.xp6(3),l.Oqu(e.statusLabel),l.xp6(1),l.Q6J("ngIf",!n.isDayAllowance(e)),l.xp6(1),l.Q6J("ngIf",n.downloadButtonIsVisibleMdOrSmallerDevice(e))}}function fe(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",40),l.NdJ("click",function(){return l.CHM(e),l.oxw(2).viewMoreHistory()}),l.TgZ(1,"a",null,41),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.qZA()}2&e&&(l.xp6(3),l.hij("",l.lcZ(4,1,"l-load-more")," "))}function ye(e,t){if(1&e&&(l.TgZ(0,"div"),l.TgZ(1,"h2",42),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.TgZ(4,"mat-accordion",43),l.YNc(5,we,42,31,"mat-expansion-panel",44),l.qZA(),l.YNc(6,fe,5,3,"div",5),l.qZA()),2&e){const e=l.oxw();l.xp6(2),l.Oqu(l.lcZ(3,3,"l-latest-requests")),l.xp6(3),l.Q6J("ngForOf",e.allowanceListHistory.records),l.xp6(1),l.Q6J("ngIf",e.allowanceListHistory.hasMoreRecords)}}function Ae(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"app-allowance-update",62),l.NdJ("deleted",function(){return l.CHM(e),l.oxw().onDeleteAllowance()})("edited",function(t){return l.CHM(e),l.oxw().getAllowanceEvent(t)}),l.qZA()}if(2&e){const e=l.oxw();l.Q6J("allowance",e.allowanceToEdit)("events",e.hourEvens)("employeeId",null==e.employeeCard||null==e.employeeCard.employee?null:e.employeeCard.employee.id)}}let Ze=(()=>{class e{constructor(e,t,i,n,o,a,s,c,p){this.allowanceService=e,this.navigationUtil=t,this.globals=i,this.windowUtilService=n,this.activatedRoute=o,this.profileService=a,this.imageService=s,this.lastAccess=c,this.permissionSelectors=p,this.pendingAllowanceList=new r.i([]),this.allowanceListHistory=new r.i([]),this.showAllowanceUpdateDialog=!0,this.allowanceId="",this.allowanceData={},this.hourEvens=new l.vpe,this.canViewAttach=!1,this.canSendAttach=!1,this.indexShowViewMoreHistoryPending=0,this.close=new l.vpe}ngOnInit(){this.initializeComponent()}ngOnDestroy(){this.paramsSubscription&&this.paramsSubscription.unsubscribe(),this.permissionsSubscription&&this.permissionsSubscription.unsubscribe()}sendHourEvent(e){this.hourEvens.emit(e)}openExcludeDialog(e){this.allowanceToExclude=e,this.excludeDialog.openDialog()}openEditDialog(e){this.allowanceToEdit=e,this.ediAllowancetDialog.initializeComponent(this.allowanceToEdit),this.ediAllowancetDialog.openDialog()}getAllowanceEvent(){return(0,a.mG)(this,void 0,void 0,function*(){yield this.initializeComponent()})}onDeleteAllowance(){this.allowanceId="",this.initializeComponent()}initializeComponent(){return(0,a.mG)(this,void 0,void 0,function*(){this.isMobileCheck(),this.dealWithParams(),this.setCountLastAccess(),this.pendingAllowanceList=yield this.listAllowanceRequests("pending",1,20),this.allowanceListHistory=yield this.listAllowanceRequests("notpending",1,5),this.watchPermissions(),0===this.pendingAllowanceList.records.length&&0===this.allowanceListHistory.records.length?this.goToRequestAllowance(!0):this.globals.listEmpty=!1,this.indexShowViewMoreHistoryPending=this.pendingAllowanceList.records.length-1})}listAllowanceRequests(e,t,i){return(0,a.mG)(this,void 0,void 0,function*(){return yield this.allowanceService.getAllowanceRequestsHistory(this.employeeId,e,t,i)})}goToRequestAllowance(e){let t;this.globals.listEmpty=e,e&&(t={replaceUrl:!0});let i="timesheet/allowances/request";this.viewIsTeamManagement&&(i+=`/${this.employeeId}`),this.navigationUtil.doNavigation(i,t)}isApproved(e){return e===c.StatusEnum.Approved}isDayAllowance(e){return!e.allowanceType.type||"day"===e.allowanceType.type}isIntervalVisible(e){let t=!0;return e.allowanceType.props&&e.allowanceType.props.forEach(e=>{("initHour"===e.field||"endHour"===e.field)&&(t=e.visible)}),t}isVisible(e,t){let i=!0;return e.allowanceType.props&&e.allowanceType.props.forEach(e=>{e.field===t&&(i=e.visible)}),i}viewMoreHistory(){return(0,a.mG)(this,void 0,void 0,function*(){const e=yield this.listAllowanceRequests("notpending",this.allowanceListHistory.getNextPage(),this.allowanceListHistory.pageSize);e&&(e.records.forEach(e=>{this.allowanceListHistory.records.push(e)}),this.allowanceListHistory.actualPage=e.actualPage,this.allowanceListHistory.hasMoreRecords=e.hasMoreRecords)})}viewMoreHistoryPending(){return(0,a.mG)(this,void 0,void 0,function*(){const e=yield this.listAllowanceRequests("pending",this.pendingAllowanceList.getNextPage(),this.pendingAllowanceList.pageSize);e&&(e.records.forEach(e=>{this.pendingAllowanceList.records.push(e)}),this.pendingAllowanceList.actualPage=e.actualPage,this.pendingAllowanceList.hasMoreRecords=e.hasMoreRecords),this.indexShowViewMoreHistoryPending=this.pendingAllowanceList.records.length-1})}isMobileCheck(){this.isMobile=this.windowUtilService.isMobileDevice()}downloadButtonIsVisibleDesktopLine1(e){return null==e.hasAttachment?this.canViewAttach&&!(this.isDayAllowance(e)&&this.isIntervalVisible(e)):this.canViewAttach&&!(this.isDayAllowance(e)&&this.isIntervalVisible(e))&&e.hasAttachment}downloadButtonIsVisibleDesktopLine2(e){return null==e.hasAttachment?this.canViewAttach&&this.isDayAllowance(e)&&this.isIntervalVisible(e):this.canViewAttach&&this.isDayAllowance(e)&&this.isIntervalVisible(e)&&e.hasAttachment}downloadButtonIsVisibleMdOrSmallerDevice(e){return null==e.hasAttachment?this.canViewAttach:this.canViewAttach&&e.hasAttachment}getAttachedFile(e){return(0,a.mG)(this,void 0,void 0,function*(){try{const t=yield this.allowanceService.getAttachedFile(e);t&&this.initializeFilePreviewDialog("timesheet/allowances/file/download",t,e)}catch(t){console.error(t)}})}initializeFilePreviewDialog(e,t,i){this.previewFileDialog.initializeComponent(e,t,i)}dealWithParams(){this.paramsSubscription=this.activatedRoute.params.subscribe(e=>{e.employeeId?(this.employeeId=e.employeeId,this.viewIsTeamManagement=!0,this.getEmployeeData()):(this.employeeId=s.N.loggedUser,this.viewIsTeamManagement=!1,this.employeeCard=null)})}setCountLastAccess(){this.globals.getEmployeeSummary().then(e=>{this.lastAccess.setLastAccess(U.uB,e.id)})}getEmployeeData(){return(0,a.mG)(this,void 0,void 0,function*(){const e=yield this.profileService.getEmployeeSummary(this.employeeId);this.employeeCard=new k.J,this.employeeCard.employee=e,this.imageService.getImageStyle(this.employeeId).subscribe(e=>this.employeeCard.image=e)})}watchPermissions(){this.permissionsSubscription=this.permissionSelectors.permissions$.subscribe(e=>{this.canViewAttach=e.viewAttachmentAllowance&&!this.viewIsTeamManagement||e.teamManagementViewAttachmentAllowance&&this.viewIsTeamManagement,this.canSendAttach=e.sendAttachmentAllowance&&!this.viewIsTeamManagement||e.teamManagementSendAttachmentAllowance&&this.viewIsTeamManagement})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(g.n),l.Y36(p._),l.Y36(Q.O),l.Y36(Y.g),l.Y36(n.gz),l.Y36(J.H),l.Y36(N.A),l.Y36(U.Lx),l.Y36(M.eL))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-allowance-list"]],viewQuery:function(e,t){if(1&e&&(l.Gf(T,5),l.Gf(L,5),l.Gf(F.K,5)),2&e){let e;l.iGM(e=l.CRH())&&(t.excludeDialog=e.first),l.iGM(e=l.CRH())&&(t.ediAllowancetDialog=e.first),l.iGM(e=l.CRH())&&(t.previewFileDialog=e.first)}},outputs:{close:"close"},decls:11,vars:11,consts:[["pageTitle","im-allowanceLong",3,"backIsVisible"],[1,"po-mb-1","po-sm-12","po-md-12","po-lg-12","po-xl-12"],[3,"image","name","role","status",4,"ngIf"],["p-primary","true","p-type","primary",1,"request-substitute-btn","po-sm-12","po-md-12","po-lg-12","po-xl-12","block",3,"p-label","p-click"],[3,"cssClass",4,"ngFor","ngForOf"],["class","next-records po-sm-12 po-md-12 po-lg-12 po-xl-12",3,"click",4,"ngIf"],[4,"ngIf"],[3,"allowance","employeeId","deleted"],[3,"allowance","events","employeeId","deleted","edited",4,"ngIf"],[3,"image","name","role","status"],[3,"cssClass"],["card-header","",1,"mr-card-header"],[1,"po-sm-10","po-md-10","po-lg-10","po-xl-10","title-label"],["class","po-sm-2 po-md-2 po-lg-2 po-xl-2 sm-no-padding",4,"ngIf"],["card-body",""],[1,"po-sm-12","po-mt-md-1","po-md-12","po-lg-4","po-xl-4","panel-item-group"],[1,"requested-label"],[1,"requested-value"],[3,"class",4,"ngIf"],["class","po-sm-6 po-mt-md-1 po-md-3 po-lg-2 po-xl-2 panel-item-group",4,"ngIf"],[1,"po-sm-12","po-mt-md-1","po-md-12","po-lg-4","po-xl-4","panel-item-group","panel-item-group-no-line"],["class","po-hidden-sm po-hidden-md po-lg-2 po-xl-2 panel-item-group pull-right",4,"ngIf"],["class","po-hidden-sm po-hidden-md po-mt-md-1 po-lg-6 po-xl-6 panel-item-group",4,"ngIf"],["class","po-hidden-sm po-hidden-md po-mt-md-1 po-lg-2 po-xl-2 panel-item-group",4,"ngIf"],["class","po-hidden-sm po-mt-md-1 po-md-6 po-hidden-lg po-hidden-xl panel-item-group",4,"ngIf"],["class","po-sm-12 po-hidden-md po-hidden-lg po-hidden-xl panel-item-group",4,"ngIf"],[1,"po-sm-2","po-md-2","po-lg-2","po-xl-2","sm-no-padding"],[1,"dropdown","mouse-pointer"],["data-toggle","dropdown",1,"po-icon","po-icon-more","see-more"],["name","ul-dropdown-options",1,"dropdown-menu","no-padding"],[1,"dropdown-arrow"],[1,"dropdown-menu-itens",3,"click"],[1,"po-sm-6","po-mt-md-1","po-md-3","po-lg-2","po-xl-2","panel-item-group"],[1,"po-hidden-sm","po-hidden-md","po-lg-2","po-xl-2","panel-item-group","pull-right"],["id","btn-download-protractor","p-icon","po-icon po-icon-attach",1,"card-download-button",3,"p-label","p-click"],[1,"po-hidden-sm","po-hidden-md","po-mt-md-1","po-lg-6","po-xl-6","panel-item-group"],[1,"po-hidden-sm","po-hidden-md","po-mt-md-1","po-lg-2","po-xl-2","panel-item-group"],["p-icon","po-icon po-icon-attach",1,"card-download-button",3,"p-label","p-click"],[1,"po-hidden-sm","po-mt-md-1","po-md-6","po-hidden-lg","po-hidden-xl","panel-item-group"],[1,"po-sm-12","po-hidden-md","po-hidden-lg","po-hidden-xl","panel-item-group"],[1,"next-records","po-sm-12","po-md-12","po-lg-12","po-xl-12",3,"click"],["linkMoreRecords",""],[1,"latest-requests","po-sm-12","po-md-12","po-lg-12","po-xl-12"],[1,"po-sm-12","po-md-12","po-lg-12","po-xl-12","no-padding"],["hideToggle","true",4,"ngFor","ngForOf"],["hideToggle","true"],["dropdown",""],[1,"dropdown-history-header"],[3,"ngClass"],[1,"historic-label","historic-label-title"],[1,"specific-class"],[1,"right-align"],["class","po-icon ico-minus ico-color",4,"ngIf"],["class","po-icon ico-plus ico-color",4,"ngIf"],[1,"line"],[1,"historic-content"],[1,"historic-label"],[1,"historic-value"],["class","download-button","p-icon","po-icon po-icon-download","p-primary","true","p-type","primary",3,"p-label","p-click",4,"ngIf"],[1,"po-icon","ico-minus","ico-color"],[1,"po-icon","ico-plus","ico-color"],["p-icon","po-icon po-icon-download","p-primary","true","p-type","primary",1,"download-button",3,"p-label","p-click"],[3,"allowance","events","employeeId","deleted","edited"]],template:function(e,t){1&e&&(l._UZ(0,"app-page-header",0),l.TgZ(1,"div",1),l.YNc(2,j,1,4,"app-card-employee",2),l.TgZ(3,"po-button",3),l.NdJ("p-click",function(){return t.goToRequestAllowance(!1)}),l.ALo(4,"translate"),l.qZA(),l.YNc(5,le,35,32,"app-card",4),l.YNc(6,se,5,3,"div",5),l.YNc(7,ye,7,5,"div",6),l.qZA(),l.TgZ(8,"app-allowance-exclude",7),l.NdJ("deleted",function(){return t.onDeleteAllowance()}),l.qZA(),l.YNc(9,Ae,1,3,"app-allowance-update",8),l._UZ(10,"app-preview-file")),2&e&&(l.Q6J("backIsVisible",t.viewIsTeamManagement),l.xp6(2),l.Q6J("ngIf",t.employeeCard&&t.employeeCard.employee),l.xp6(1),l.s9C("p-label",l.lcZ(4,9,"l-new-allowance")),l.xp6(2),l.Q6J("ngForOf",null==t.pendingAllowanceList?null:t.pendingAllowanceList.records),l.xp6(1),l.Q6J("ngIf",t.pendingAllowanceList.hasMoreRecords),l.xp6(1),l.Q6J("ngIf",t.allowanceListHistory.records&&t.allowanceListHistory.records.length),l.xp6(1),l.Q6J("allowance",t.allowanceToExclude)("employeeId",null==t.employeeCard||null==t.employeeCard.employee?null:t.employeeCard.employee.id),l.xp6(1),l.Q6J("ngIf",t.showAllowanceUpdateDialog))},directives:[R.q,m.O5,d.bOz,m.sg,T,F.K,G.x,z.A,$.pp,$.ib,$.yz,$.yK,m.mk,$.u4,L],pipes:[w.X$,f.$,y.P],styles:['.right-align[_ngcontent-%COMP%]{position:relative;width:100%}.right-align[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;right:0}.mat-expansion-panel[_ngcontent-%COMP%]{box-shadow:0 2px 8px #e3e6f1!important;border-radius:6px;position:relative;background:#ffffff;display:flow-root;padding:0;margin-bottom:16px}.dropdown-history-header[_ngcontent-%COMP%]{font-weight:bold;font-size:16px;color:#2b3639}.historic-content[_ngcontent-%COMP%]{padding:0 24px}.historic-value[_ngcontent-%COMP%]{float:right;color:#2b3639}.historic-label[_ngcontent-%COMP%]{color:#4a5c60}.historic-label-link[_ngcontent-%COMP%]{cursor:pointer;color:#0c9abe}.next-records[_ngcontent-%COMP%]{background-color:transparent;text-align:center;font-size:16px;font-weight:bold;line-height:3;color:#0c9abe;padding-bottom:20px;cursor:pointer}.title-label[_ngcontent-%COMP%]{margin-top:0;padding-left:8px}.subtitle-opacity[_ngcontent-%COMP%]{opacity:.7}.requested-label[_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 480px){.title-label[_ngcontent-%COMP%], .panel-item-group[_ngcontent-%COMP%]{padding:0}.panel-item-group[_ngcontent-%COMP%]{position:relative;margin:8px 0}}.historic-label[_ngcontent-%COMP%]{font-weight:bold;color:#4a5c60}.historic-value[_ngcontent-%COMP%]{float:right;font-weight:bold;color:#2b3639}.requested-value[_ngcontent-%COMP%]{color:#4a5c60}.containter-allowances[_ngcontent-%COMP%]{padding:0;margin-bottom:40px}.infos-margin[_ngcontent-%COMP%]{margin-top:16px}.situation-a[_ngcontent-%COMP%]{background:#c64840}.situation-f[_ngcontent-%COMP%]{background:#ea9a3e}.situation-n[_ngcontent-%COMP%]{background:#00b28e}.situation-container[_ngcontent-%COMP%]{border-radius:5px;padding:0 4px}.request-substitute-btn[_ngcontent-%COMP%]{padding:0;margin-bottom:10px}[_nghost-%COMP%]     .po-info-container-content{padding:0!important}[_nghost-%COMP%]     .po-button{height:42px}[_nghost-%COMP%]     .panel-item-group{padding-bottom:0}[_nghost-%COMP%]     .mat-expansion-panel-header-description{margin-right:0}[_nghost-%COMP%]     .po-container{margin-top:25px;padding:0}.ico-color[_ngcontent-%COMP%]{color:#0c9abe}.circleBase[_ngcontent-%COMP%]{border-radius:50%}.type1[_ngcontent-%COMP%]{display:inline-block;width:15px;height:15px;background:#00b28e}.type2[_ngcontent-%COMP%]{display:inline-block;width:15px;height:15px;background:#c64840}.historic-label-title[_ngcontent-%COMP%]{padding-left:7px}.link[_ngcontent-%COMP%]{cursor:pointer;font-weight:bold}[_nghost-%COMP%]     .po-button-link{border-color:#0c9abe;color:#0c9abe}@media only screen and (max-width: 960px){[_nghost-%COMP%]     .po-button-link{margin-top:5px}}@media only screen and (max-width: 960px){.hide-situation[_ngcontent-%COMP%]{display:none}}.text-area[_ngcontent-%COMP%]{height:200px;background-color:#fff;color:#0c9abe}.dropdown-arrow[_ngcontent-%COMP%]{box-shadow:-1px -1px 1px rgba(0,0,0,.1);background-color:#fff;top:-3px;-webkit-transform:rotate(45deg);transform:rotate(45deg);height:8px;width:8px;left:50%;position:relative;z-index:10}.dropdown[_ngcontent-%COMP%]{float:right}.dropdown-menu-itens[_ngcontent-%COMP%]{cursor:default;text-align:left;font-weight:400;background-color:#fff;color:#0c9abe;line-height:44px;width:100%;padding-left:16px;margin-top:-4px;cursor:pointer!important;border-radius:3px}.dropdown-menu-itens[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.dropdown-menu[_ngcontent-%COMP%]{top:100%;min-width:80px;left:auto!important}.see-more[_ngcontent-%COMP%]{color:#0c9abe;font-size:20px}.card-employee[_ngcontent-%COMP%]{padding:0}[_nghost-%COMP%]     .card-employee{margin-bottom:-10px}[_nghost-%COMP%]     .avatar-small{margin-left:16px;margin-top:16px;height:42px;width:42px}.download-button[_ngcontent-%COMP%]     button{height:32px;float:right;margin:15px 24px 0 0}.download-button[_ngcontent-%COMP%]     button span{font-family:"NunitoSans",sans-serif}h2[_ngcontent-%COMP%]{color:#4a5c60}@media screen and (min-width: 481px){h2[_ngcontent-%COMP%]{font-family:"NunitoSans";font-size:27px}}[_nghost-%COMP%]     .card-request-active{background:#fff!important;color:#000!important}.latest-requests[_ngcontent-%COMP%]{margin-top:44px}.card-download-button[_ngcontent-%COMP%]     button{width:100%;height:30px}@media screen and (min-width: 481px){.card-download-button[_ngcontent-%COMP%]     button{height:46px}}.card-download-button[_ngcontent-%COMP%]     button .po-icon{font-size:22px}']}),e})();var xe=i(98348),be=i(81059),ve=i(64634),Te=i(40469);class Me{constructor(){this.initHour="",this.endHour="",this.totalHour="",this.justify=""}}var qe=i(23831),Ce=i(57706);const Oe=["allowanceForm"];function _e(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",13),l.TgZ(1,"div",17),l.TgZ(2,"po-datepicker",22),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw(2).allowanceView.initDate=t}),l.ALo(3,"translate"),l.qZA(),l.qZA(),l.TgZ(4,"div",17),l.TgZ(5,"po-datepicker",23),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw(2).allowanceView.endDate=t}),l.ALo(6,"translate"),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.oxw(2);l.xp6(2),l.s9C("p-label",l.lcZ(3,6,"l-initial-date")),l.Q6J("ngModel",e.allowanceView.initDate)("p-disabled",!e.hasOptionSelected),l.xp6(3),l.s9C("p-label",l.lcZ(6,8,"l-end-date")),l.Q6J("ngModel",e.allowanceView.endDate)("p-disabled",!e.hasOptionSelected)}}function He(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",13),l.TgZ(1,"div",17),l.TgZ(2,"po-datepicker",22),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw(2).allowanceView.initDate=t}),l.ALo(3,"translate"),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.oxw(2);l.xp6(2),l.s9C("p-label",l.lcZ(3,3,"l-date")),l.Q6J("ngModel",e.allowanceView.initDate)("p-disabled",!e.hasOptionSelected)}}function Pe(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",13),l.TgZ(1,"div",17),l.TgZ(2,"po-input",24),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw(2).allowanceView.totalHour=t})("p-blur",function(){return l.CHM(e),l.oxw(2).changeTotalHour()})("p-change-model",function(){return l.CHM(e),l.oxw(2).checkAllowanceTypeView()}),l.ALo(3,"translate"),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.oxw(2);l.xp6(2),l.s9C("p-label",l.lcZ(3,6,"l-total")),l.Q6J("p-required",e.isRequired(e.allowanceView.selectedView,"totalHour"))("p-disabled",!e.isEditable(e.allowanceView.selectedView,"totalHour")||e.isAllowanceTimeTypePeriod()||!e.hasOptionSelected)("ngModel",e.allowanceView.totalHour)("p-mask",e.mask)("p-pattern",e.pattern)}}function Ie(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",13),l.TgZ(1,"div",25),l.TgZ(2,"span",26),l._uU(3),l.ALo(4,"translate"),l.qZA(),l._UZ(5,"span",27),l.TgZ(6,"div",28),l.TgZ(7,"textarea",29),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw(2).allowanceView.justify=t}),l.qZA(),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.oxw(2);l.xp6(3),l.Oqu(l.lcZ(4,3,"l-justification")),l.xp6(4),l.Q6J("disabled",!e.isEditable(e.allowanceView.selectedView,"justify")||!e.hasOptionSelected)("ngModel",e.allowanceView.justify)}}function De(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",13),l.TgZ(1,"div",30),l.TgZ(2,"app-attach-file",31),l.NdJ("attachedFileChange",function(t){return l.CHM(e),l.oxw(2).fillFileInfo(t)}),l.qZA(),l.qZA(),l.qZA()}}function Ve(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",11),l.TgZ(1,"form",null,12),l.TgZ(3,"div",13),l.TgZ(4,"div",14),l.TgZ(5,"po-select",15),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw().type=t})("p-change",function(){return l.CHM(e),l.oxw().onChangeAllowanceTypeEvent()}),l.ALo(6,"translate"),l.ALo(7,"translate"),l.qZA(),l.qZA(),l.qZA(),l.YNc(8,_e,7,10,"div",16),l.YNc(9,He,4,5,"div",16),l.TgZ(10,"div",13),l.TgZ(11,"div",17),l.TgZ(12,"po-input",18),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw().allowanceView.initHour=t})("p-blur",function(){return l.CHM(e),l.oxw().changeInitHour()})("p-change-model",function(){return l.CHM(e),l.oxw().checkAllowanceTypeView()}),l.ALo(13,"translate"),l.qZA(),l.qZA(),l.TgZ(14,"div",17),l.TgZ(15,"po-input",19),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw().allowanceView.endHour=t})("p-blur",function(){return l.CHM(e),l.oxw().changeEndHour()})("p-change-model",function(){return l.CHM(e),l.oxw().checkAllowanceTypeView()}),l.ALo(16,"translate"),l.qZA(),l.qZA(),l.qZA(),l.YNc(17,Pe,4,8,"div",16),l.YNc(18,Ie,8,5,"div",16),l.YNc(19,De,3,0,"div",16),l.TgZ(20,"div",13),l.TgZ(21,"div",20),l.TgZ(22,"po-button",21),l.NdJ("p-click",function(){return l.CHM(e),l.oxw().saveAllowances()}),l.ALo(23,"translate"),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.MAs(2),t=l.oxw();l.xp6(5),l.s9C("p-label",l.lcZ(6,23,"l-allowanceType")),l.s9C("p-placeholder",l.lcZ(7,25,"l-select-option")),l.Q6J("ngModel",t.type)("p-options",t.types),l.xp6(3),l.Q6J("ngIf",t.isVisible(t.allowanceView.selectedView,"endDate")),l.xp6(1),l.Q6J("ngIf",!t.isVisible(t.allowanceView.selectedView,"endDate")),l.xp6(3),l.s9C("p-label",l.lcZ(13,27,"l-initial-hour")),l.Q6J("p-required",t.isRequired(t.allowanceView.selectedView,"initHour"))("p-disabled",!t.isEditable(t.allowanceView.selectedView,"initHour")||t.isAllowanceTimeTypeTotalHour()||!t.hasOptionSelected)("ngModel",t.allowanceView.initHour)("p-mask",t.mask)("p-pattern",t.pattern),l.xp6(3),l.s9C("p-label",l.lcZ(16,29,"l-final-hour")),l.Q6J("p-required",t.isRequired(t.allowanceView.selectedView,"endHour"))("p-disabled",!t.isEditable(t.allowanceView.selectedView,"endHour")||t.isAllowanceTimeTypeTotalHour()||!t.hasOptionSelected)("ngModel",t.allowanceView.endHour)("p-mask",t.mask)("p-pattern",t.pattern),l.xp6(2),l.Q6J("ngIf",t.isVisible(t.allowanceView.selectedView,"totalHour")),l.xp6(1),l.Q6J("ngIf",t.isVisible(t.allowanceView.selectedView,"justify")),l.xp6(1),l.Q6J("ngIf",t.canSendAttach&&t.hasOptionSelected),l.xp6(3),l.s9C("p-label",l.lcZ(23,31,"l-save")),l.Q6J("p-disabled",!e.form.valid)}}var Ee=(()=>{return(e=Ee||(Ee={}))[e.ALL_ENABLED=1]="ALL_ENABLED",e[e.PERIOD=2]="PERIOD",e[e.TOTAL_HOUR=3]="TOTAL_HOUR",Ee;var e})();let Se=(()=>{class e extends be.R{constructor(e,t,i,n,o,a,l,c,r){super(),this.allowanceService=e,this.notificationService=t,this.appTranslateService=i,this.menuApplicationService=n,this.globals=o,this.navigationUtil=a,this.windowUtilService=l,this.activatedRoute=c,this.permissionSelectors=r,this.allowanceView=new Me,this.allowanceTypes=[],this.dialogIsVisible=!1,this.showForm=!1,this.mask="99:99",this.pattern="^(2[0-3]|[01]*[0-9]):?([0-5][0-9])$",this.allowanceTimeTypeEnum=Ee.ALL_ENABLED,this.canSendAttach=!1,this.types=[],this.hasOptionSelected=!1,this.loggedUser=s.N.loggedUser,this.isTeamManagement=!1}ngOnInit(){const e=Object.create(null,{ngOnInit:{get:()=>super.ngOnInit}});return(0,a.mG)(this,void 0,void 0,function*(){yield this.getEmployeeSummary(),this.getAllowanceTypes(),this.showMenu(),this.dealWithParams(),this.dealWithQueryParams(),this.watchPermissions(),e.ngOnInit.call(this)})}ngOnDestroy(){this.paramsSubscription&&this.paramsSubscription.unsubscribe(),this.queryParamsSubscription&&this.queryParamsSubscription.unsubscribe(),this.permissionsSubscription&&this.permissionsSubscription.unsubscribe()}back(){if(this.globals.urlHistory.length>0&&this.globals.urlHistory.pop(),0===this.globals.urlHistory.length){let e;e=this.windowUtilService.isMobileDevice()?"menu/timesheetSubMenu/l-timesheet":"home",this.navigationUtil.doNavigation(e,{replaceUrl:!0})}else this.windowUtilService.back()}changeInitHour(){this.allowanceView.initHour=q.Em.changeHour(this.allowanceView.initHour)}changeEndHour(){this.allowanceView.endHour=q.Em.changeHour(this.allowanceView.endHour)}changeTotalHour(){this.allowanceView.totalHour=q.Em.changeHour(this.allowanceView.totalHour)}saveAllowances(){this.validateAllowance()&&this.allowanceService.saveAllowances(this.employeeId?this.employeeId:s.N.loggedUser,this.getAllowanceObject(this.allowanceView)).then(()=>{this.globals.listEmpty=!1,this.openDialog()})}showMenu(){this.menuApplicationService.showMenu()}getAllowanceTypes(){this.allowanceService.getAllowancesTypes().then(e=>{this.types=e.map(e=>({label:e.description,value:e.id})),this.allowanceTypes=e,this.allowanceView.selectedView={description:"",id:""},this.showForm=!0}).catch(e=>{console.error("Erro ao requisitar os tipos de abono: "+e)})}dealWithParams(){this.paramsSubscription=this.activatedRoute.params.subscribe(e=>{this.employeeId=e.employeeId,this.isTeamManagement=null!=this.employeeId})}dealWithQueryParams(){this.queryParamsSubscription=this.activatedRoute.queryParams.subscribe(e=>{const t=e;t.date&&(this.allowanceView.initDate=q.Em.getDateUTCFormat(new Date(Number(t.date))),isNaN(this.allowanceView.initDate.getTime())&&(this.allowanceView.initDate=null)),t.endDate&&(this.allowanceView.endDate=q.Em.getDateUTCFormat(new Date(Number(t.endDate))),isNaN(this.allowanceView.endDate.getTime())&&(this.allowanceView.endDate=null)),null!=t.startHour&&(this.allowanceView.initHour=t.startHour),null!=t.endHour&&(this.allowanceView.endHour=t.endHour)})}validateAllowance(){const e=this.isEditable(this.allowanceView.selectedView,"initHour"),t=this.isEditable(this.allowanceView.selectedView,"endHour"),i=this.isEditable(this.allowanceView.selectedView,"totalHour"),n=this.isEditable(this.allowanceView.selectedView,"endDate");return this.isVisible(this.allowanceView.selectedView,"endDate")&&Date.parse(this.allowanceView.initDate.toString())>Date.parse(this.allowanceView.endDate.toString())?(this.appTranslateService.getI18n("m-initialDateBiggerThanEndDate").then(e=>{this.notificationService.showNotification(e,d.ik9.Error)}),!1):!(!this.validateHours(e,t,i)||!this.validateAttachment()||""==this.allowanceView.selectedView.id)&&this.sameDay(e,t,n)}validateAttachment(){var e;return!(null===(e=this.allowanceView)||void 0===e?void 0:e.selectedView)||!this.allowanceView.selectedView.requiredAttachment||null!=this.attachedFile||(this.appTranslateService.getI18n("l-required-attachment").then(e=>{this.notificationService.showNotification(e,d.ik9.Error)}),!1)}validateHours(e,t,i){if(this.allHoursIsEditableAndEnabled(e,t,i)&&this.hoursIsEmpty())return this.appTranslateService.getI18n("m-dataInvalid").then(e=>{this.notificationService.showNotification(e,d.ik9.Error)}),!1;if(e&&t&&!i){if(ve.m.isEmpty(this.allowanceView.initHour))return this.appTranslateService.getI18n("m-initHourInvalid").then(e=>{this.notificationService.showNotification(e,d.ik9.Error)}),!1;if(ve.m.isEmpty(this.allowanceView.endHour))return this.appTranslateService.getI18n("m-endHourInvalid").then(e=>{this.notificationService.showNotification(e,d.ik9.Error)}),!1}return!(!e&&!t&&i&&ve.m.isEmpty(this.allowanceView.totalHour)&&(this.appTranslateService.getI18n("m-totalHourInvalid").then(e=>{this.notificationService.showNotification(e,d.ik9.Error)}),1))}allHoursIsEditableAndEnabled(e,t,i){return e&&t&&i&&this.allowanceTimeTypeEnum===Ee.ALL_ENABLED}hoursIsEmpty(){return ve.m.isEmpty(this.allowanceView.initHour)&&ve.m.isEmpty(this.allowanceView.endHour)&&ve.m.isEmpty(this.allowanceView.totalHour)}sameDay(e,t,i){if(e&&t&&i||this.isDatasul()&&e&&t&&!1===this.employeeSummary.employeeNightShift){const e=new Date(Date.parse(this.allowanceView.initDate.toString())),t=this.allowanceView.endDate?new Date(Date.parse(this.allowanceView.endDate.toString())):e;if(e.toLocaleDateString()===t.toLocaleDateString()&&+this.allowanceView.endHour<+this.allowanceView.initHour)return this.appTranslateService.getI18n("m-initialHourBiggerThanEndHour").then(e=>{this.notificationService.showNotification(e,d.ik9.Error)}),!1}return!0}getAllowanceObject(e){const t=e=>""!==e?q.Em.getTotalMilliseconds((e=>e.substr(0,2).concat(":").concat(e.substr(2,3)))(e)):0,i={description:e.selectedView.description,id:e.selectedView.id,type:e.selectedView.type};return this.isVisible(e.selectedView,"endDate")||(e.endDate=e.initDate),{id:"",initDate:new Date(e.initDate),initHour:t(e.initHour),endDate:new Date(e.endDate),endHour:t(e.endHour),allowanceType:i,justify:e.justify,totalMinutes:t(e.totalHour),statusLabel:"",status:"pending",canAlter:!1,file:this.attachedFile,hasAttachment:null!=this.attachedFile}}getEmployeeSummary(){return(0,a.mG)(this,void 0,void 0,function*(){if(this.employeeSummary=yield this.globals.getEmployeeSummary(),this.employeeSummary)return this.employeeSummary.employeeNightShift})}isDatasul(){return xe.ZP.isErpDatasul()}isVisible(e,t){return!(e&&e.props&&e.props.length)||u.Z.isVisible(e.props,t)}isEditable(e,t){return!(e&&e.props&&e.props.length)||u.Z.isEditable(e.props,t)}isRequired(e,t){return!!(e&&e.props&&e.props.length)&&u.Z.isRequired(e.props,t)}calculateDifferenceTime(){this.allowanceView.initHour&&this.allowanceView.endHour&&(this.allowanceView.totalHour=q.Em.calculateDifferenceTime(this.allowanceView.initHour,this.allowanceView.endHour))}checkAllowanceTypeView(){if(!this.hoursIsEmpty())return ve.m.isEmpty(this.allowanceView.initHour)&&ve.m.isEmpty(this.allowanceView.endHour)?ve.m.isEmpty(this.allowanceView.initHour)&&ve.m.isEmpty(this.allowanceView.endHour)&&!ve.m.isEmpty(this.allowanceView.totalHour)?(this.allowanceTimeTypeEnum=Ee.TOTAL_HOUR,this.allowanceView.initHour="",void(this.allowanceView.endHour="")):void 0:(this.allowanceTimeTypeEnum=Ee.PERIOD,void(this.allowanceView.totalHour=""));this.allowanceTimeTypeEnum=Ee.ALL_ENABLED}onChangeAllowanceTypeEvent(){this.fillAllowanceTypeSelectedProperties(),this.isEditable(this.allowanceView.selectedView,"initHour")||(this.allowanceView.initHour=""),this.isEditable(this.allowanceView.selectedView,"endHour")||(this.allowanceView.endHour=""),this.isEditable(this.allowanceView.selectedView,"totalHour")||(this.allowanceView.totalHour="")}openDialog(){this.dialogIsVisible=!0}restartForm(){this.allowanceForm.resetForm(),this.getAllowanceTypes(),this.attachedFile=null,this.attachFile.excludeAttachedFile(),this.dialogIsVisible=!1}backToAllowanceRequestsHistory(){this.dialogIsVisible=!1,this.showMenu(),this.employeeId!==this.loggedUser?this.windowUtilService.back():this.navigationUtil.doNavigation("timesheet/allowances")}isAllowanceTimeTypePeriod(){return this.allowanceTimeTypeEnum===Ee.PERIOD}isAllowanceTimeTypeTotalHour(){return this.allowanceTimeTypeEnum===Ee.TOTAL_HOUR}fillFileInfo(e){this.attachedFile=e}watchPermissions(){this.permissionsSubscription=this.permissionSelectors.permissions$.subscribe(e=>{this.canSendAttach=e.sendAttachmentAllowance&&!this.isTeamManagement||e.teamManagementSendAttachmentAllowance&&this.isTeamManagement})}fillAllowanceTypeSelectedProperties(){const e=this.allowanceTypes.find(e=>e.id===this.type);e&&(this.hasOptionSelected=!0,this.allowanceView.selectedView={id:this.type,description:e.description,requiredAttachment:e.requiredAttachment,props:e.props,type:e.type})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(g.n),l.Y36(C.g),l.Y36(h.g),l.Y36(Te.Kv),l.Y36(Q.O),l.Y36(p._),l.Y36(Y.g),l.Y36(n.gz),l.Y36(M.eL))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-allowance"]],viewQuery:function(e,t){if(1&e&&(l.Gf(_.n,5),l.Gf(Oe,5)),2&e){let e;l.iGM(e=l.CRH())&&(t.attachFile=e.first),l.iGM(e=l.CRH())&&(t.allowanceForm=e.first)}},features:[l.qOj],decls:17,vars:12,consts:[["pageTitle","l-abono-request",3,"backIsVisible","backFunction"],[3,"date","employeeId"],["class","header-divider",4,"ngIf"],["id","allowance-confirm",3,"isVisible","closeDialogButtonEnable","closeDialogEvent"],["dialog-content","",1,"dialog-allowance-content"],[1,"message-allowance","po-xl-12","po-lg-12","po-md-12","po-sm-12",3,"click"],[1,"text-center"],[1,"allowance-image-success","mouse-pointer",3,"click"],["id","lbl-mensage-success",1,"mouse-pointer",3,"click"],[1,"new-allowance-container","text-center","po-xl-12","po-lg-12","po-md-12","po-sm-12",3,"click"],[1,"a-new-allowance","mouse-pointer","no-padding",3,"click"],[1,"header-divider"],["allowanceForm","ngForm"],[1,"po-row"],["id","container-allowanceType",1,"po-xl-12","po-lg-12","po-md-12","po-sm-12"],["name","typeSelect","p-required","",3,"ngModel","p-options","p-label","p-placeholder","ngModelChange","p-change"],["class","po-row",4,"ngIf"],[1,"po-xl-6","po-lg-6","po-md-6","po-sm-6"],["p-placeholder","00:00","id","initHour","name","initHour","p-maxlength","5",1,"label-ellipsis",3,"p-required","p-disabled","ngModel","p-label","p-mask","p-pattern","ngModelChange","p-blur","p-change-model"],["p-placeholder","00:00","id","endHour","name","endHour","p-maxlength","5",3,"p-required","p-disabled","ngModel","p-label","p-mask","p-pattern","ngModelChange","p-blur","p-change-model"],[1,"po-xl-12","po-lg-12","po-md-12","po-sm-12","margin-field","margin-field-top"],["p-type","primary","p-primary","true","id","saveButton","name","saveButton",1,"pull-right","save-button",3,"p-label","p-disabled","p-click"],["p-format","dd/mm/yyyy","id","initDate","name","initDate","p-required","",3,"ngModel","p-disabled","p-label","ngModelChange"],["p-format","dd/mm/yyyy","id","endDate","name","endDate","p-required","",3,"ngModel","p-disabled","p-label","ngModelChange"],["p-placeholder","00:00","id","totalHour","name","totalHour","p-maxlength","5",1,"label-justify",3,"p-required","p-disabled","ngModel","p-label","p-mask","p-pattern","ngModelChange","p-blur","p-change-model"],[1,"po-xl-12","po-lg-12","po-md-12","po-sm-12","margin-field"],[1,"po-label","label-justify"],[1,"po-label-help"],[1,"po-field-flex-container"],["rows","3","id","justify","name","justify",1,"form-control","textarea-justify",3,"disabled","ngModel","ngModelChange"],[1,"po-xl-12","po-lg-12","po-md-12","po-sm-12"],[3,"attachedFileChange"]],template:function(e,t){1&e&&(l.TgZ(0,"app-page-header",0),l.NdJ("backFunction",function(){return t.back()}),l.qZA(),l._UZ(1,"app-daily-summary",1),l.YNc(2,Ve,24,33,"div",2),l.TgZ(3,"app-dialog",3),l.NdJ("closeDialogEvent",function(){return t.backToAllowanceRequestsHistory()}),l.TgZ(4,"div",4),l.TgZ(5,"div",5),l.NdJ("click",function(){return t.backToAllowanceRequestsHistory()}),l.TgZ(6,"div",6),l.TgZ(7,"div",6),l.TgZ(8,"div",7),l.NdJ("click",function(){return t.backToAllowanceRequestsHistory()}),l.qZA(),l.qZA(),l.TgZ(9,"strong"),l.TgZ(10,"h4",8),l.NdJ("click",function(){return t.backToAllowanceRequestsHistory()}),l._uU(11),l.ALo(12,"translate"),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(13,"div",9),l.NdJ("click",function(){return t.restartForm()}),l.TgZ(14,"a",10),l.NdJ("click",function(){return t.restartForm()}),l._uU(15),l.ALo(16,"translate"),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&e&&(l.Q6J("backIsVisible",!0),l.xp6(1),l.Q6J("date",t.allowanceView.initDate)("employeeId",t.employeeId),l.xp6(1),l.Q6J("ngIf",t.showForm),l.xp6(1),l.Q6J("isVisible",t.dialogIsVisible)("closeDialogButtonEnable",!0),l.xp6(8),l.hij(" ",l.lcZ(12,8,"m-allowance-request-success")," "),l.xp6(4),l.hij(" ",l.lcZ(16,10,"l-request-new-allowance"),""))},directives:[R.q,qe.o,m.O5,Ce.a,O._Y,O.JL,O.F,d.C9q,O.JJ,O.On,d.xxV,d.bOz,d.GWy,O.Fj,_.n],pipes:[w.X$],styles:['#allowanceType[_ngcontent-%COMP%]{height:36px;font-size:16px}.margin-field[_ngcontent-%COMP%]{margin-bottom:20px!important}.margin-field-top[_ngcontent-%COMP%]{margin-top:20px!important}#container-allowanceType[_ngcontent-%COMP%]{margin-bottom:20px}#label-allowanceType[_ngcontent-%COMP%], .label-justify[_ngcontent-%COMP%]{margin-bottom:4px;font-family:"NunitoSans-Bold";color:#4a5c60;padding-bottom:4px}.label-justify[_ngcontent-%COMP%]{margin-top:4px}.textarea-justify[_ngcontent-%COMP%]{margin-top:12px}.label-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.message-allowance[_ngcontent-%COMP%]{position:fixed;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);padding-left:10%;padding-right:10%}[_nghost-%COMP%]     .po-datepicker-popup-calendar .po-calendar{position:fixed!important}.a-new-allowance[_ngcontent-%COMP%]{font-size:18px;color:#0c9abe;font-weight:bold}.new-allowance-container[_ngcontent-%COMP%]{box-shadow:inset 0 2px #dbdedf;position:fixed;padding:6%;bottom:0px;left:0px;width:100%}.allowance-image-success[_ngcontent-%COMP%]{background:url(success.8b4116fbb4d6691356b7.png) no-repeat center;width:100%;height:64px;margin-bottom:20px}.header-divider[_ngcontent-%COMP%]{padding:16px 8px 8px}@media only screen and (-webkit-min-device-pixel-ratio: 2),only screen and (min--moz-device-pixel-ratio: 2),only screen and (-o-min-device-pixel-ratio: 2/1){.allowance-image-success[_ngcontent-%COMP%]{background:url(success@2x.3ef849f18cc8db5e719a.png) no-repeat center;width:100%;height:64px;background-size:contain}}@media (min-width: 961px){.dialog-allowance-content[_ngcontent-%COMP%]{height:350px}.message-allowance[_ngcontent-%COMP%]{position:fixed;left:50%;top:40%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}}app-attach-file[_ngcontent-%COMP%]     .attach-file-box{padding:0}.save-button[_ngcontent-%COMP%]     button{width:160px;height:44px}@media screen and (max-width: 480px){.save-button[_ngcontent-%COMP%]{width:100%}.save-button[_ngcontent-%COMP%]     button{width:100%}}  .po-field-container-bottom{display:contents}']}),e})();const Le=[{path:"",component:Ze,canActivate:[o.P]},{path:"request",component:Se,canActivate:[o.P]},{path:"request/:employeeId",component:Se,canActivate:[o.P]}];let ke=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({providers:[g.n],imports:[[n.Bz.forChild(Le)],n.Bz]}),e})()}}]);